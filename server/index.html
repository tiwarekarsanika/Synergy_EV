<!-- AIzaSyDzjhGRFc6zr04vdTOqLt-gVc9V32S9Lm4 -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EV Trip Planner</title>
</head>
<body>
  <div>
    <label for="remainingBattery">Remaining Battery Level (%):</label>
    <input type="number" id="remainingBattery" min="0" max="100" placeholder="Enter remaining battery level">
  </div>

  <div>
    <label for="totalRange">Total Range on Full Charge (kilometers):</label>
    <input type="number" id="totalRange" min="1" placeholder="Enter total range">
  </div>

  <div>
    <label for="energyConsmp">Energy Consumption (Wh per kilometer):</label>
    <input type="number" id="energyConsmp" min="1" placeholder="Enter efficiency in Wh/km">
  </div>

  <button onclick="calculateRemainingDistance()">Calculate Remaining Distance</button>

  <div id="result" style="margin-top: 10px;"></div>

  <div>
    <label for="startLocation">Enter Starting Location:</label>
    <input type="text" id="startLocation" placeholder="Enter starting location">
  </div>

  <div>
    <label for="endLocation">Enter Ending Location:</label>
    <input type="text" id="endLocation" placeholder="Enter ending location">
  </div>

  <button onclick="planTrip()">Plan Trip</button>

  <div id="map" style="height: 400px; margin-top: 10px;"></div>

  <button onclick="startDirections()">Start Driving Directions</button>

  <script>
    function calculateRemainingDistance() {
      var remainingBattery = parseFloat(document.getElementById('remainingBattery').value);
      var totalRange = parseFloat(document.getElementById('totalRange').value);
      var energyConsumption = parseFloat(document.getElementById('energyConsmp').value);

      if (isNaN(remainingBattery) || isNaN(totalRange) || isNaN(energyConsumption) || 
          remainingBattery < 0 || remainingBattery > 100 || energyConsumption <= 0) {
        alert('Please enter valid information.');
        return;
      }

      // Calculate remaining distance based on remaining battery level and consumption
      battCap = totalRange * energyConsumption
      battRem = (remainingBattery / 100) * battCap
      var remainingDistance =  battRem / energyConsumption;

      document.getElementById('result').innerText = 'Estimated Remaining Distance: ' + remainingDistance.toFixed(2) + ' kilometers';
    }

    var map;
    var directionsService;
    var directionsRenderer;

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: -34.397, lng: 150.644},
        zoom: 8
      });

      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map
      });
    }

    function planTrip() {
      var startLocation = document.getElementById('startLocation').value;
      var endLocation = document.getElementById('endLocation').value;

      if (startLocation === '' || endLocation === '' || isNaN(chargingStops) || chargingStops < 0) {
        alert('Please enter valid information.');
        return;
      }

      var request = {
        origin: startLocation,
        destination: endLocation,
        travelMode: 'DRIVING'
      };

      directionsService.route(request, function(response, status) {
        if (status == 'OK') {
          var waypoints = generateChargingStations(response.routes[0].overview_path, chargingStops);
          updateRouteWithWaypoints(request, waypoints);
        } else {
          console.error('Directions request failed due to ' + status);
        }
      });
    }

    function generateChargingStations(path, numStations) {
      var stations = [];
      var increment = Math.floor(path.length / (numStations + 1));

      for (var i = 1; i <= numStations; i++) {
        stations.push({
          location: path[i * increment],
          stopover: true
        });
      }

      return stations;
    }

    function updateRouteWithWaypoints(request, waypoints) {
      request.waypoints = waypoints;

      directionsService.route(request, function(response, status) {
        if (status == 'OK') {
          directionsRenderer.setDirections(response);
        } else {
          console.error('Directions request failed due to ' + status);
        }
      });
    }

    function startDirections() {
      directionsService.route({
        origin: document.getElementById('startLocation').value,
        destination: document.getElementById('endLocation').value,
        waypoints: [],
        travelMode: 'DRIVING'
      }, function(response, status) {
        if (status == 'OK') {
          directionsRenderer.setDirections(response);
        } else {
          console.error('Directions request failed due to ' + status);
        }
      });
    }
  </script>

  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDzjhGRFc6zr04vdTOqLt-gVc9V32S9Lm4&callback=initMap"></script>
</body>
</html>


